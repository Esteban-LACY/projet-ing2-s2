<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Publier un logement - OmnesBnB</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #fff; }
    .container-publier { max-width: 1100px; margin: auto; }
    .transition { transition: all .2s; }
    .onglet-header { border: none !important; box-shadow: none !important; }
    @media (max-width: 768px) {
      .container-publier { max-width: 100%; padding: 0 0.5rem; }
      .table-box, .form-box { padding: 1.1rem 0.6rem !important; }
      .header-title { font-size: 2rem !important; }
      .header-sub { font-size: 1.1rem !important; }
      .td-actions {
        flex-direction: column !important;
        gap: 0.5rem !important;
        align-items: flex-end !important; /* aligné en bas sur mobile aussi */
      }
      .btn-modifier, .btn-supprimer {
        font-size: 0.9rem !important;
        padding: 0.5rem !important;
        min-width: 0 !important;
        width: 100% !important;
      }
    }
    .table-box table {
      table-layout: fixed;
      width: 100%;
    }
    .table-box th, .table-box td {
      word-break: break-word;
      white-space: normal;
    }
  </style>
</head>
<body class="bg-white">
  <!-- HEADER & ONGLET -->
  <header class="bg-white sticky top-0 z-50 border-b-2 border-black shadow-sm">
    <div class="container mx-auto px-4">
      <div class="flex items-center justify-between h-16">
        <a href="index.html" class="logo-bnb text-black font-bold text-xl">OmnesBnB</a>
        <nav class="hidden md:flex items-center space-x-6">
          <a href="recherche.html" class="text-sm text-black hover:text-black">Chercher</a>
          <a href="publier.html" class="text-sm text-black hover:text-black">Publier</a>
          <a href="mes-locations.html" class="text-sm text-black hover:text-black">Mes locations</a>
          <div class="h-8 w-px mx-3 border-l-2 border-black"></div>
          <a href="connexion.html" class="text-sm bg-black text-white py-2 px-6 rounded-lg hover:bg-gray-800">Connexion / Inscription</a>
        </nav>
        <div class="md:hidden">
          <button id="menu-burger" class="flex items-center p-2 rounded-lg border-2 border-black">
            <i class="fas fa-bars text-gray-700"></i>
          </button>
        </div>
      </div>
      <div id="menu-mobile" class="md:hidden hidden py-3">
        <a href="recherche.html" class="block py-2 text-sm text-black font-medium text-center">Chercher</a>
        <a href="publier.html" class="block py-2 text-sm text-black font-medium text-center">Publier</a>
        <a href="mes-locations.html" class="block py-2 text-sm text-black font-medium text-center">Mes locations</a>
        <div class="w-4/5 mx-auto border-t-2 border-black my-3"></div>
        <a href="connexion.html" class="block text-sm bg-black text-white py-2 px-6 rounded-lg text-center hover:bg-gray-800">
          Connexion / Inscription
        </a>
      </div>
    </div>
  </header>
  <section class="bg-black py-12 px-4 flex flex-col items-center justify-center">
    <h1 class="text-white text-4xl md:text-5xl font-bold mb-3 text-center leading-tight">Publier ou gérer vos annonces</h1>
    <p class="text-white text-lg md:text-2xl mb-8 opacity-90 text-center">Décrivez votre logement ou gérez vos annonces existantes.</p>
    <div class="bg-white border-2 border-black rounded-2xl shadow-lg max-w-3xl w-full mx-auto p-0 flex flex-col items-center relative overflow-visible">
      <div class="flex w-full items-stretch relative" style="min-height:72px">
        <button id="onglet-nouveau" class="onglet-header flex-1 text-2xl font-bold py-5 transition text-black focus:outline-none z-10">Nouvelle annonce</button>
        <div class="absolute top-0 bottom-0 left-1/2 transform -translate-x-1/2 w-px border-l-2 border-black z-20"></div>
        <button id="onglet-modifier" class="onglet-header flex-1 text-2xl font-bold py-5 transition text-gray-400 hover:text-black focus:outline-none z-10">Gérer mes annonces</button>
      </div>
    </div>
  </section>
  <section id="zone-publier" class="py-10 px-2 bg-white">
    <div class="container-publier">
      <!-- Bloc Nouvelle annonce -->
      <div id="bloc-nouveau" class="w-full">
        <form class="form-box bg-white border-2 border-black rounded-2xl shadow-lg p-8 mx-auto space-y-8">
          <div>
            <label for="titre" class="block text-lg font-semibold text-gray-700 mb-2">Titre de l'annonce</label>
            <input type="text" id="titre" name="titre"
              placeholder="Ex: Studio lumineux près du campus"
              class="w-full border-2 border-black rounded-lg py-3 px-4 bg-white text-gray-900 text-lg placeholder-gray-400 focus:outline-none" required />
          </div>
          <div>
            <label for="type-logement" class="block text-lg font-semibold text-gray-700 mb-2">Type de logement</label>
            <select id="type-logement" name="type-logement"
              class="w-full border-2 border-black rounded-lg py-3 px-4 bg-white text-gray-900 text-lg focus:outline-none" required>
              <option value="">Sélectionnez</option>
              <option value="studio">Studio</option>
              <option value="appartement">Appartement</option>
              <option value="chambre">Chambre</option>
              <option value="colocation">Colocation</option>
              <option value="autre">Autre</option>
            </select>
          </div>
          <div>
            <label for="adresse" class="block text-lg font-semibold text-gray-700 mb-2">Adresse complète</label>
            <input type="text" id="adresse" name="adresse"
              placeholder="Ex: 23 Rue Victor Hugo, 69000 Lyon"
              class="w-full border-2 border-black rounded-lg py-3 px-4 bg-white text-gray-900 text-lg placeholder-gray-400 focus:outline-none" required />
          </div>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label class="block text-lg font-semibold text-gray-700 mb-2">Prix / nuit (€)</label>
              <input type="number" name="prix_nuit" placeholder="Ex: 50"
                class="w-full border-2 border-black rounded-lg py-3 px-4 bg-white text-gray-900 text-lg placeholder-gray-400 focus:outline-none" required />
            </div>
            <div>
              <label class="block text-lg font-semibold text-gray-700 mb-2">Prix / semaine (€)</label>
              <input type="number" name="prix_semaine" placeholder="Ex: 300"
                class="w-full border-2 border-black rounded-lg py-3 px-4 bg-white text-gray-900 text-lg placeholder-gray-400 focus:outline-none" required />
            </div>
            <div>
              <label class="block text-lg font-semibold text-gray-700 mb-2">Prix / mois (€)</label>
              <input type="number" name="prix_mois" placeholder="Ex: 900"
                class="w-full border-2 border-black rounded-lg py-3 px-4 bg-white text-gray-900 text-lg placeholder-gray-400 focus:outline-none" required />
            </div>
            <div>
              <label class="block text-lg font-semibold text-gray-700 mb-2">Prix / année (€)</label>
              <input type="number" name="prix_annee" placeholder="Ex: 10500"
                class="w-full border-2 border-black rounded-lg py-3 px-4 bg-white text-gray-900 text-lg placeholder-gray-400 focus:outline-none" required />
            </div>
            <div class="md:col-span-2">
              <label for="caution" class="block text-lg font-semibold text-gray-700 mb-2">Caution (€)</label>
              <input type="number" id="caution" name="caution" placeholder="Ex: 1000"
                class="w-full border-2 border-black rounded-lg py-3 px-4 bg-white text-gray-900 text-lg placeholder-gray-400 focus:outline-none" required />
            </div>
          </div>
          <div>
            <label for="photo_principale" class="block text-lg font-semibold text-gray-700 mb-2">Photo principale</label>
            <input type="file" id="photo_principale" name="photo_principale"
              accept="image/png, image/jpeg, image/webp"
              class="w-full file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-2 file:border-black file:text-black file:bg-white file:font-semibold"
              required />
          </div>
          <div>
            <label for="photos_annexes" class="block text-lg font-semibold text-gray-700 mt-4 mb-2">Photos annexes</label>
            <input type="file" id="photos_annexes" name="photos_annexes" multiple
              accept="image/png, image/jpeg, image/webp"
              class="w-full file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-2 file:border-black file:text-black file:bg-white file:font-semibold" />
            <p class="text-xs text-gray-500 mt-1">Formats acceptés : jpg, png, webp.</p>
          </div>
          <div>
            <label for="description" class="block text-lg font-semibold text-gray-700 mb-2">Description</label>
            <textarea id="description" name="description" rows="4"
              placeholder="Décrivez votre logement, les points forts, etc."
              class="w-full border-2 border-black rounded-lg py-3 px-4 bg-white text-gray-900 text-lg placeholder-gray-400 focus:outline-none"></textarea>
          </div>
          <button type="submit"
            class="bg-black text-white font-bold py-4 px-8 rounded-lg w-full hover:bg-gray-800 transition-all shadow-md text-2xl">
            Publier l'annonce
          </button>
        </form>
      </div>
      <!-- Bloc Gérer mes annonces -->
      <div id="bloc-modifier" class="w-full hidden">
        <div class="table-box bg-white border-2 border-black rounded-2xl shadow-lg p-8 mx-auto">
          <h2 class="text-2xl font-bold mb-4 text-center">Vos annonces</h2>
          <table class="w-full border-collapse">
            <thead>
              <tr>
                <th class="border-b-2 border-black px-2 py-2 text-left text-lg font-semibold">Titre</th>
                <th class="border-b-2 border-black px-2 py-2 text-left text-lg font-semibold">Statut</th>
                <th class="border-b-2 border-black px-2 py-2 text-left text-lg font-semibold">Action</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="border-b border-gray-200 px-2 py-3 text-xs md:text-base">Studio lumineux près du campus</td>
                <td class="border-b border-gray-200 px-2 py-3 text-xs md:text-base">Publiée</td>
                <td class="td-actions border-b border-gray-200 px-2 py-3 flex flex-col sm:flex-row gap-1 items-end justify-end min-w-0 w-full">
                  <button class="btn-modifier bg-black text-white py-2 px-2 md:px-4 rounded-lg hover:bg-gray-800 transition-all text-xs sm:text-sm w-full sm:w-auto min-w-0">Modif.</button>
                  <button class="btn-supprimer bg-white text-black py-2 px-2 md:px-4 rounded-lg border-2 border-black hover:bg-red-100 transition-all text-xs sm:text-sm w-full sm:w-auto min-w-0">Supp.</button>
                </td>
              </tr>
              <tr>
                <td class="border-b border-gray-200 px-2 py-3 text-xs md:text-base">Appartement T2 centre-ville</td>
                <td class="border-b border-gray-200 px-2 py-3 text-xs md:text-base">Louée</td>
                <td class="td-actions border-b border-gray-200 px-2 py-3 flex flex-col sm:flex-row gap-1 items-end justify-end min-w-0 w-full">
                  <button disabled class="bg-gray-200 text-gray-400 py-2 px-2 md:px-4 rounded-lg text-xs sm:text-sm w-full sm:w-auto min-w-0 cursor-not-allowed">Modif.</button>
                  <button disabled class="bg-gray-200 text-gray-400 py-2 px-2 md:px-4 rounded-lg text-xs sm:text-sm w-full sm:w-auto min-w-0 cursor-not-allowed">Supp.</button>
                </td>
              </tr>
              <tr>
                <td class="border-b border-gray-200 px-2 py-3 text-xs md:text-base">Appartement étudiant non-publié</td>
                <td class="border-b border-gray-200 px-2 py-3 text-xs md:text-base">Non-publiée</td>
                <td class="td-actions border-b border-gray-200 px-2 py-3 flex flex-col sm:flex-row gap-1 items-end justify-end min-w-0 w-full">
                  <button class="btn-modifier bg-black text-white py-2 px-2 md:px-4 rounded-lg hover:bg-gray-800 transition-all text-xs sm:text-sm w-full sm:w-auto min-w-0">Modif.</button>
                  <button class="btn-supprimer bg-white text-black py-2 px-2 md:px-4 rounded-lg border-2 border-black hover:bg-red-100 transition-all text-xs sm:text-sm w-full sm:w-auto min-w-0">Supp.</button>
                </td>
              </tr>
            </tbody>
          </table>
          <div id="formulaire-modif" class="hidden mt-8"></div>
        </div>
      </div>
    </div>
  </section>
  <section class="bg-black text-white py-12 px-4">
    <div class="container mx-auto max-w-3xl text-center">
      <h2 class="text-2xl font-bold mb-4">Et maintenant ?</h2>
      <p class="text-sm mb-6 opacity-90">
        N'hésitez pas à découvrir nos logements en ligne sur OmnesBnB, et trouvez votre futur chez-vous en quelques clics.
      </p>
      <a href="recherche.html" class="footer-btn bg-white text-black font-medium py-2 px-6 rounded-lg border border-white hover:bg-gray-100 inline-flex items-center shadow-md">
        <i class="fas fa-magnifying-glass mr-2"></i> Chercher un logement
      </a>
      <div class="mt-12 pt-4 border-t border-gray-700 mx-auto w-full"></div>
      <div class="text-center text-gray-400 text-xs mt-4">
        &copy; 2025 OmnesBnB. Tous droits réservés.
      </div>
    </div>
  </section>
  <script>
    // Responsive menu mobile
    document.getElementById('menu-burger').addEventListener('click', function() {
      document.getElementById('menu-mobile').classList.toggle('hidden');
    });

    // Onglets header
    const ongletNouveau = document.getElementById('onglet-nouveau');
    const ongletModifier = document.getElementById('onglet-modifier');
    const blocNouveau = document.getElementById('bloc-nouveau');
    const blocModifier = document.getElementById('bloc-modifier');

    // Sélection des boutons/links du header + logo + bouton footer à désactiver aussi
    const headerLinks = Array.from(document.querySelectorAll('header nav a, header nav button'));
    const logoBNB = document.querySelector('a.logo-bnb');
    const footerBtn = document.querySelector('a.footer-btn');
    const allLockable = headerLinks.concat([logoBNB, footerBtn]);

    function lockHeaderLinks(lock) {
      allLockable.forEach(link => {
        if (!link) return;
        if (lock) {
          link.classList.add('cursor-not-allowed', 'opacity-60');
          link.dataset.oldHref = link.getAttribute('href');
          link.removeAttribute('href');
          link.addEventListener('click', preventDefaultHandler);
        } else {
          link.classList.remove('cursor-not-allowed', 'opacity-60');
          if (link.dataset.oldHref) link.setAttribute('href', link.dataset.oldHref);
          link.removeEventListener('click', preventDefaultHandler);
        }
      });
    }
    function preventDefaultHandler(e) { e.preventDefault(); }

    function afficherNouveau() {
      if (window._editLock) return;
      ongletNouveau.classList.add('text-black');
      ongletNouveau.classList.remove('text-gray-400', 'cursor-not-allowed');
      ongletModifier.classList.add('text-gray-400');
      ongletModifier.classList.remove('text-black', 'cursor-not-allowed');
      blocNouveau.classList.remove('hidden');
      blocModifier.classList.add('hidden');
    }
    function afficherModifier() {
      if (window._editLock) return;
      ongletModifier.classList.add('text-black');
      ongletModifier.classList.remove('text-gray-400', 'cursor-not-allowed');
      ongletNouveau.classList.add('text-gray-400');
      ongletNouveau.classList.remove('text-black', 'cursor-not-allowed');
      blocModifier.classList.remove('hidden');
      blocNouveau.classList.add('hidden');
    }
    ongletNouveau.addEventListener('click', afficherNouveau);
    ongletModifier.addEventListener('click', afficherModifier);
    afficherNouveau();

    // Modification dynamique (formulaire dépliable) sur "Gérer mes annonces"
    document.querySelectorAll('#bloc-modifier .btn-modifier').forEach(function(btn){
      btn.addEventListener('click', function(e){
        e.preventDefault();
        const formModif = document.getElementById('formulaire-modif');
        let titre = btn.closest('tr').children[0].textContent.trim();
        let etat = btn.closest('tr').children[1].textContent.trim();
        if(etat === "Louée" || window._editLock) return;
        window._editLock = true;

        // Désactive tout le reste (Modifier/Supprimer + onglets + header links + logo + footer)
        document.querySelectorAll('#bloc-modifier .btn-modifier').forEach(function(button) {
          button.disabled = true;
          button.classList.add('opacity-50', 'cursor-not-allowed');
        });
        document.querySelectorAll('#bloc-modifier .btn-supprimer').forEach(function(suppBtn) {
          suppBtn.disabled = true;
          suppBtn.classList.add('opacity-50', 'cursor-not-allowed');
        });
        [ongletNouveau, ongletModifier].forEach(function(onglet) {
          onglet.classList.add('cursor-not-allowed', 'opacity-60');
          onglet.disabled = true;
        });
        lockHeaderLinks(true);

        btn.disabled = false;
        btn.classList.remove('opacity-50', 'cursor-not-allowed');

        formModif.innerHTML = `
        <form class="form-box bg-white border-2 border-black rounded-2xl shadow-lg p-6 mx-auto space-y-6 animate-fade-in">
          <h3 class="text-lg font-bold mb-4">Modifier l'annonce "<span class="text-black">${titre}</span>"</h3>
          <div>
              <label class="block text-base font-semibold text-gray-700 mb-1">Titre de l'annonce</label>
              <input type="text" value="${titre}" class="w-full border-2 border-black rounded-lg py-2 px-3 bg-white text-gray-900 text-base placeholder-gray-400 focus:outline-none"/>
          </div>
          <div>
              <label class="block text-base font-semibold text-gray-700 mb-1">Type de logement</label>
              <select class="w-full border-2 border-black rounded-lg py-2 px-3 bg-white text-gray-900 text-base focus:outline-none">
                  <option>Studio</option>
                  <option>Appartement</option>
                  <option>Chambre</option>
                  <option>Colocation</option>
                  <option>Autre</option>
              </select>
          </div>
          <div>
              <label class="block text-base font-semibold text-gray-700 mb-1">Adresse complète</label>
              <input type="text" class="w-full border-2 border-black rounded-lg py-2 px-3 bg-white text-gray-900 text-base placeholder-gray-400 focus:outline-none"/>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                  <label class="block text-base font-semibold text-gray-700 mb-1">Prix / nuit (€)</label>
                  <input type="number" class="w-full border-2 border-black rounded-lg py-2 px-3 bg-white text-gray-900 text-base placeholder-gray-400 focus:outline-none" required />
              </div>
              <div>
                  <label class="block text-base font-semibold text-gray-700 mb-1">Prix / semaine (€)</label>
                  <input type="number" class="w-full border-2 border-black rounded-lg py-2 px-3 bg-white text-gray-900 text-base placeholder-gray-400 focus:outline-none" required />
              </div>
              <div>
                  <label class="block text-base font-semibold text-gray-700 mb-1">Prix / mois (€)</label>
                  <input type="number" class="w-full border-2 border-black rounded-lg py-2 px-3 bg-white text-gray-900 text-base placeholder-gray-400 focus:outline-none" required />
              </div>
              <div>
                  <label class="block text-base font-semibold text-gray-700 mb-1">Prix / année (€)</label>
                  <input type="number" class="w-full border-2 border-black rounded-lg py-2 px-3 bg-white text-gray-900 text-base placeholder-gray-400 focus:outline-none" required />
              </div>
              <div class="md:col-span-2">
                  <label class="block text-base font-semibold text-gray-700 mb-1">Caution (€)</label>
                  <input type="number" class="w-full border-2 border-black rounded-lg py-2 px-3 bg-white text-gray-900 text-base placeholder-gray-400 focus:outline-none" required />
              </div>
          </div>
          <div>
              <label class="block text-base font-semibold text-gray-700 mb-1">Photo principale</label>
              <input type="file" accept="image/png, image/jpeg, image/webp"
                  class="w-full text-base file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-2 file:border-black file:text-black file:bg-white file:font-semibold"/>
              <p class="text-xs text-gray-500 mt-1">Sélectionnez la photo principale (formats : jpg, png, webp).</p>
          </div>
          <div>
              <label class="block text-base font-semibold text-gray-700 mb-1">Photos annexes</label>
              <input type="file" multiple accept="image/png, image/jpeg, image/webp"
                  class="w-full text-base file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-2 file:border-black file:text-black file:bg-white file:font-semibold"/>
              <p class="text-xs text-gray-500 mt-1">Ajoutez une ou plusieurs photos annexes (formats : jpg, png, webp).</p>
          </div>
          <div>
              <label class="block text-base font-semibold text-gray-700 mb-1">Description</label>
              <textarea rows="3"
                  class="w-full border-2 border-black rounded-lg py-2 px-3 bg-white text-gray-900 text-base placeholder-gray-400 focus:outline-none"></textarea>
          </div>
          <div class="flex flex-col md:flex-row gap-4">
              <button type="submit" class="bg-black text-white font-bold py-3 px-8 rounded-lg w-full hover:bg-gray-800 transition-all shadow-md text-lg">
                  Enregistrer les modifications
              </button>
              <button type="button" id="btn-annuler" class="bg-white text-black font-bold py-3 px-8 rounded-lg w-full border-2 border-black hover:bg-gray-100 transition-all shadow-md text-lg">
                  Annuler les modifications
              </button>
          </div>
        </form>
        `;
        formModif.classList.remove('hidden');
        formModif.scrollIntoView({behavior:"smooth", block:"start"});
        document.getElementById('btn-annuler').addEventListener('click', function() {
          formModif.classList.add('hidden');
          formModif.innerHTML = "";
          document.querySelectorAll('#bloc-modifier .btn-modifier').forEach(function(button) {
            button.disabled = false;
            button.classList.remove('opacity-50', 'cursor-not-allowed');
          });
          document.querySelectorAll('#bloc-modifier .btn-supprimer').forEach(function(suppBtn) {
            suppBtn.disabled = false;
            suppBtn.classList.remove('opacity-50', 'cursor-not-allowed');
          });
          [ongletNouveau, ongletModifier].forEach(function(onglet) {
            onglet.classList.remove('cursor-not-allowed', 'opacity-60');
            onglet.disabled = false;
          });
          lockHeaderLinks(false);
          window._editLock = false;
        });
      });
    });
  </script>
</body>
</html>
